

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Use case 3: Signal production and ground distribution &mdash; ShowerModel 0.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Use case 4: Observatory events" href="UC4_Observatory_events.html" />
    <link rel="prev" title="Use case 2: Shower profiles" href="UC2_Shower_profile.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> ShowerModel
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="UC0_Playing_around_with_ShowerModel.html">Use case 0: Playing around with ShowerModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="UC1_Track_visualization.html">Use case 1: Shower tracks</a></li>
<li class="toctree-l2"><a class="reference internal" href="UC2_Shower_profile.html">Use case 2: Shower profiles</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Use case 3: Signal production and ground distribution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Setting-telescope-characteristics">Setting telescope characteristics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Signal-production">Signal production</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Example-of-signal-calculation-in-‘fluorescence-mode’">Example of signal calculation in ‘fluorescence mode’</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Photon-distribution-at-observation-level">Photon distribution at observation level</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="UC4_Observatory_events.html">Use case 4: Observatory events</a></li>
<li class="toctree-l2"><a class="reference internal" href="UC5_Camera_images.html">Use case 5: Camera images</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ShowerModel.html">ShowerModel package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">References</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ShowerModel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Tutorials</a> &raquo;</li>
        
      <li>Use case 3: Signal production and ground distribution</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorials/UC3_Signal_production_and_ground_distribution.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Use-case-3:-Signal-production-and-ground-distribution">
<h1>Use case 3: Signal production and ground distribution<a class="headerlink" href="#Use-case-3:-Signal-production-and-ground-distribution" title="Permalink to this headline">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">showermodel</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
<p>This notebook describes how to use the <code class="docutils literal notranslate"><span class="pre">Telescope</span></code> class to set the desired characteristics of a telescope and the <code class="docutils literal notranslate"><span class="pre">Signal</span></code> class to compute the signal produced in a telescope that detects a shower. The <code class="docutils literal notranslate"><span class="pre">Signal</span></code> class uses all the classes described in previous notebooks (i.e., <code class="docutils literal notranslate"><span class="pre">Atmosphere</span></code>, <code class="docutils literal notranslate"><span class="pre">Track</span></code>, <code class="docutils literal notranslate"><span class="pre">Telescope</span></code>, <code class="docutils literal notranslate"><span class="pre">Projection</span></code>, <code class="docutils literal notranslate"><span class="pre">Profile</span></code>, <code class="docutils literal notranslate"><span class="pre">Fluorescence</span></code>, <code class="docutils literal notranslate"><span class="pre">Cherenkov</span></code>). Special functions to show the signal evolution and the photon distribution on ground are also described.</p>
<div class="section" id="Setting-telescope-characteristics">
<h2>Setting telescope characteristics<a class="headerlink" href="#Setting-telescope-characteristics" title="Permalink to this headline">¶</a></h2>
<p>The default <code class="docutils literal notranslate"><span class="pre">Telescope</span></code> object is of subclass <code class="docutils literal notranslate"><span class="pre">IACT</span></code>, which uses the detection efficiency, angular aperture and detection area based on Medium Size Telescopes (MST) of CTA.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">telescope1</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Telescope</span><span class="p">()</span>  <span class="c1"># = sm.Telescope(tel_type=&#39;IACT&#39;)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Default telescope type:&quot;</span><span class="p">,</span> <span class="n">telescope1</span><span class="o">.</span><span class="n">tel_type</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Default angular aperture in degrees:&quot;</span><span class="p">,</span> <span class="n">telescope1</span><span class="o">.</span><span class="n">apert</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Default detection area in m2:&quot;</span><span class="p">,</span> <span class="n">telescope1</span><span class="o">.</span><span class="n">area</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Default telescope type: IACT
Default angular aperture in degrees: 8.0
Default detection area in m2: 113.097
</pre></div></div>
</div>
<p>However, if the parameter <code class="docutils literal notranslate"><span class="pre">tel_type</span></code> is set to something different to a predefined <code class="docutils literal notranslate"><span class="pre">Telescope</span></code> subclass name (more subclasses apart from <code class="docutils literal notranslate"><span class="pre">IACT</span></code> will be implemented), a generic telescope with 100 % efficiency in the 290 - 430 nm range, aperture of 10 degrees and 100 m<span class="math notranslate nohighlight">\(^2\)</span> area is generated.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">telescope2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Telescope</span><span class="p">(</span><span class="n">tel_type</span><span class="o">=</span><span class="s1">&#39;generic&#39;</span><span class="p">)</span>  <span class="c1"># tel_type may be set to None, for instance</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Generic telescope type:&quot;</span><span class="p">,</span> <span class="n">telescope2</span><span class="o">.</span><span class="n">tel_type</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Angular aperture of generic telescope i n degrees:&quot;</span><span class="p">,</span> <span class="n">telescope2</span><span class="o">.</span><span class="n">apert</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Detection area of generic telescope in m2:&quot;</span><span class="p">,</span> <span class="n">telescope2</span><span class="o">.</span><span class="n">area</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generic telescope type: generic
Angular aperture of generic telescope i n degrees: 10.0
Detection area of generic telescope in m2: 100.0
</pre></div></div>
</div>
<p>To modify the detection efficiency, it must be input a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> object with two columns: Wavelength in nm (with constant discretization step) and efficiency in decimal fraction.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">efficiency</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;wvl&#39;</span><span class="p">,</span> <span class="s1">&#39;eff&#39;</span><span class="p">])</span>
<span class="n">efficiency</span><span class="o">.</span><span class="n">wvl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">332.</span><span class="p">,</span> <span class="mf">343.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>  <span class="c1"># Last value is 342 nm</span>
<span class="n">efficiency</span><span class="o">.</span><span class="n">eff</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span> <span class="p">((</span><span class="n">efficiency</span><span class="o">.</span><span class="n">wvl</span> <span class="o">-</span> <span class="mf">337.</span><span class="p">)</span> <span class="o">/</span><span class="mf">1.</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Pass-band filter</span>

<span class="n">telescope3</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Telescope</span><span class="p">(</span><span class="n">tel_type</span><span class="o">=</span><span class="s1">&#39;user_defined&#39;</span><span class="p">,</span> <span class="n">efficiency</span><span class="o">=</span><span class="n">efficiency</span><span class="p">,</span> <span class="n">apert</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="mf">120.</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;User-defined telescope type:&quot;</span><span class="p">,</span> <span class="n">telescope3</span><span class="o">.</span><span class="n">tel_type</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Angular aperture in degrees:&quot;</span><span class="p">,</span> <span class="n">telescope3</span><span class="o">.</span><span class="n">apert</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Detection area in m2:&quot;</span><span class="p">,</span> <span class="n">telescope3</span><span class="o">.</span><span class="n">area</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
User-defined telescope type: user_defined
Angular aperture in degrees: 10.0
Detection area in m2: 120.0
</pre></div></div>
</div>
<p>Below is a comparison of the detection efficiencies of the three above-defined <code class="docutils literal notranslate"><span class="pre">Telescope</span></code> objects.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># telescope1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">telescope1</span><span class="o">.</span><span class="n">wvl_cher</span><span class="p">,</span> <span class="n">telescope1</span><span class="o">.</span><span class="n">eff_cher</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">);</span>  <span class="c1"># Efficieny defined in the range 280 - 600 nm</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">telescope1</span><span class="o">.</span><span class="n">wvl_fluo</span><span class="p">,</span> <span class="n">telescope1</span><span class="o">.</span><span class="n">eff_fluo</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span>

<span class="c1"># telescope2</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">telescope2</span><span class="o">.</span><span class="n">wvl_cher</span><span class="p">,</span> <span class="n">telescope2</span><span class="o">.</span><span class="n">eff_cher</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;generic&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">telescope2</span><span class="o">.</span><span class="n">wvl_fluo</span><span class="p">,</span> <span class="n">telescope2</span><span class="o">.</span><span class="n">eff_fluo</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;fluo. bands&#39;</span><span class="p">);</span>

<span class="c1"># telescope3</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">telescope3</span><span class="o">.</span><span class="n">wvl_cher</span><span class="p">,</span> <span class="n">telescope3</span><span class="o">.</span><span class="n">eff_cher</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;user_defined&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">telescope3</span><span class="o">.</span><span class="n">wvl_fluo</span><span class="p">,</span> <span class="n">telescope3</span><span class="o">.</span><span class="n">eff_fluo</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_UC3_Signal_production_and_ground_distribution_11_0.png" src="../_images/tutorials_UC3_Signal_production_and_ground_distribution_11_0.png" />
</div>
</div>
<p>A new telescope type can be defined by the user from an existing <code class="docutils literal notranslate"><span class="pre">Telescope</span></code> object, but with some changes.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">telescope4</span> <span class="o">=</span> <span class="n">telescope2</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mf">20.</span><span class="p">,</span> <span class="n">az</span><span class="o">=</span><span class="mf">120.</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="mf">50.</span><span class="p">,</span> <span class="n">tel_type</span><span class="o">=</span><span class="s1">&#39;my_tel&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Help on <code class="docutils literal notranslate"><span class="pre">Telescope</span></code> constructor.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># sm.Telescope?</span>
</pre></div>
</div>
</div>
<p>Help on <code class="docutils literal notranslate"><span class="pre">Telescope</span></code> object.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># telescope4?</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Signal-production">
<h2>Signal production<a class="headerlink" href="#Signal-production" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">The number of photons from a shower that are collected by a telescope can be obtained by computing the fraction of solid angle covered by the telescope area subtended at each shower point and the atmospheric transmission. In this code, only Rayleigh scattering is considered to evaluate the atmospheric transmission taking a mass attenuation length of 1645 g/cm<span class="math notranslate nohighlight">\(^2\)</span> at 350 nm, increasing with wavelength to the fourth power.</div>
<div class="line">The Cherenkov light is assumed to follow a <span class="math notranslate nohighlight">\(1/\lambda^2\)</span> distribution, whereas the fluorescence production is calculated for the 34 bands between 290 and 430nm (circles of the figure above).</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">telescope</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Telescope</span><span class="p">()</span>

<span class="n">wvl</span> <span class="o">=</span> <span class="n">telescope</span><span class="o">.</span><span class="n">wvl_cher</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wvl</span><span class="p">,</span> <span class="n">telescope</span><span class="o">.</span><span class="n">eff_cher</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Detection efficiency&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wvl</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">600.</span><span class="o">/</span><span class="mi">1645</span><span class="o">*</span><span class="p">(</span><span class="mf">350.</span><span class="o">/</span><span class="n">wvl</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Atm. transmission&#39;</span><span class="p">)</span>  <span class="c1"># Shower-to-telescope distance of 600g/cm2</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_UC3_Signal_production_and_ground_distribution_20_0.png" src="../_images/tutorials_UC3_Signal_production_and_ground_distribution_20_0.png" />
</div>
</div>
<p>The calculated signal production is stored in a <code class="docutils literal notranslate"><span class="pre">Signal</span></code> object that is constructed from a <code class="docutils literal notranslate"><span class="pre">Shower</span></code> and <code class="docutils literal notranslate"><span class="pre">Telescope</span></code> objects.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">shower</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Shower</span><span class="p">(</span><span class="n">theta</span><span class="o">=</span><span class="mf">20.</span><span class="p">,</span> <span class="n">az</span><span class="o">=</span><span class="mf">30.</span><span class="p">)</span>
<span class="n">telescope</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Telescope</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mf">22.</span><span class="p">,</span> <span class="n">az</span><span class="o">=</span><span class="mf">30.</span><span class="p">)</span>

<span class="n">signal</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Signal</span><span class="p">(</span><span class="n">telescope</span><span class="p">,</span> <span class="n">shower</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>By default, both the atmospheric transmission and telescope efficiency are included, but they may be turned off.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># signal = sm.Signal(telescope, shower, atm_trans=False, tel_eff=False)</span>
</pre></div>
</div>
</div>
<p>If the telescope efficiency is not included, the wavelength range defined in the <code class="docutils literal notranslate"><span class="pre">Telescope</span></code> object is used, unless it is modified via the parameters <code class="docutils literal notranslate"><span class="pre">wvl_ini</span></code>, <code class="docutils literal notranslate"><span class="pre">wvl_fin</span></code> and <code class="docutils literal notranslate"><span class="pre">wvl_step</span></code>, where <code class="docutils literal notranslate"><span class="pre">wvl_step</span></code> is the discretization step to integrate the wavelenght-dependent atmospheric transmission.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># signal = sm.Signal(telescope, shower, tel_eff=False, wvl_ini=350., wvl_fin=500., wvl_step=5.)</span>
</pre></div>
</div>
</div>
<p>The resulting <code class="docutils literal notranslate"><span class="pre">Signal</span></code> object is a subclass of <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>. It stores the number of photoelectrons for shower points within the telescope field of view.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">signal</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Npe_fluo</th>
      <th>Npe_cher</th>
      <th>Npe_total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>27</td>
      <td>1.434683e+00</td>
      <td>170.943719</td>
      <td>172.378403</td>
    </tr>
    <tr>
      <td>28</td>
      <td>1.295066e+00</td>
      <td>162.391762</td>
      <td>163.686828</td>
    </tr>
    <tr>
      <td>29</td>
      <td>1.165408e+00</td>
      <td>153.355354</td>
      <td>154.520762</td>
    </tr>
    <tr>
      <td>30</td>
      <td>1.045440e+00</td>
      <td>143.411226</td>
      <td>144.456666</td>
    </tr>
    <tr>
      <td>31</td>
      <td>9.348576e-01</td>
      <td>133.893892</td>
      <td>134.828750</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>187</td>
      <td>1.053899e-07</td>
      <td>0.000022</td>
      <td>0.000022</td>
    </tr>
    <tr>
      <td>188</td>
      <td>1.031746e-07</td>
      <td>0.000022</td>
      <td>0.000022</td>
    </tr>
    <tr>
      <td>189</td>
      <td>9.888124e-08</td>
      <td>0.000021</td>
      <td>0.000021</td>
    </tr>
    <tr>
      <td>190</td>
      <td>9.478589e-08</td>
      <td>0.000020</td>
      <td>0.000020</td>
    </tr>
    <tr>
      <td>191</td>
      <td>9.087834e-08</td>
      <td>0.000019</td>
      <td>0.000019</td>
    </tr>
  </tbody>
</table>
<p>165 rows × 3 columns</p>
</div></div>
</div>
<p>Note: The very beginning of the shower profile (s&lt;0.01) is ignored to speed up calculations.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">Signal</span></code> object contains a <code class="docutils literal notranslate"><span class="pre">Shower</span></code> and <code class="docutils literal notranslate"><span class="pre">Telescope</span></code> objects, as well as a <code class="docutils literal notranslate"><span class="pre">Projection</span></code> object that is constructed from these objects.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># signal.shower</span>
<span class="c1"># signal.telescope</span>
<span class="c1"># signal.projection</span>
<span class="c1"># signal.atmosphere  # Equivalent to signal.shower.atmosphere or signal.projection.atmosphere</span>
<span class="c1"># signal.track</span>
</pre></div>
</div>
</div>
<p>There are some useful attributes of the <code class="docutils literal notranslate"><span class="pre">Signal</span></code> objects.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Atmospheric transmission included:&quot;</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">atm_trans</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Telescope efficiency included:&quot;</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">tel_eff</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Wavelenght range:&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">wvl_ini</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">wvl_fin</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">wvl_step</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sum of photoelectrons due to Cherenkov light:&quot;</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">Npe_cher_sum</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sum of photoelectrons due to fluorescence light:&quot;</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">Npe_fluo_sum</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sum of photoelectrons due to both light components:&quot;</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">Npe_total_sum</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Atmospheric transmission included: True
Telescope efficiency included: True
Wavelenght range: (280.0, 600.0, 3.0)
Sum of photoelectrons due to Cherenkov light: 1954.9150373114026
Sum of photoelectrons due to fluorescence light: 12.450960780869774
Sum of photoelectrons due to both light components: 1967.3659980922723
</pre></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Signal</span></code> objects include a method to plot the signal evolution as a function of both time and beta angle, which is the angular distance of the shower track from the telescope point of view.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">signal</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_UC3_Signal_production_and_ground_distribution_35_0.png" src="../_images/tutorials_UC3_Signal_production_and_ground_distribution_35_0.png" />
</div>
</div>
<p>There are also some inherited methods from <code class="docutils literal notranslate"><span class="pre">Shower</span></code> and <code class="docutils literal notranslate"><span class="pre">Projection</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># signal.show_profile();</span>
<span class="c1"># signal.show_light_production();</span>
<span class="n">signal</span><span class="o">.</span><span class="n">show_projection</span><span class="p">(</span><span class="n">max_theta</span><span class="o">=</span><span class="mf">6.</span><span class="p">);</span>  <span class="c1"># Equivalent to shower.show_projection(telescope, max_theta=6.)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_UC3_Signal_production_and_ground_distribution_37_0.png" src="../_images/tutorials_UC3_Signal_production_and_ground_distribution_37_0.png" />
</div>
</div>
<p>Help on <code class="docutils literal notranslate"><span class="pre">Signal</span></code> constructor.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># sm.Signal?</span>
</pre></div>
</div>
</div>
<p>Help on <code class="docutils literal notranslate"><span class="pre">Signal</span></code> objects.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># signal?</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Example-of-signal-calculation-in-‘fluorescence-mode’">
<h2>Example of signal calculation in ‘fluorescence mode’<a class="headerlink" href="#Example-of-signal-calculation-in-‘fluorescence-mode’" title="Permalink to this headline">¶</a></h2>
<p>1 EeV proton shower observed transversely by a fluorescence telescope, such that the telescope is pointing at the shower maximum.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">shower</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Shower</span><span class="p">(</span><span class="n">E</span><span class="o">=</span><span class="mf">1.e12</span><span class="p">,</span> <span class="n">prf_model</span><span class="o">=</span><span class="s1">&#39;Gaisser-Hillas&#39;</span><span class="p">,</span> <span class="n">X_max</span><span class="o">=</span><span class="mf">500.</span><span class="p">,</span> <span class="n">x0</span><span class="o">=-</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mf">12.</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mf">45.</span><span class="p">,</span> <span class="n">az</span><span class="o">=</span><span class="mf">20.</span><span class="p">)</span>
<span class="c1"># Large FoV fluorescence telescope at the origin of coordinates</span>
<span class="n">telescope</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Telescope</span><span class="p">(</span><span class="n">apert</span><span class="o">=</span><span class="mf">40.</span><span class="p">)</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">shower</span><span class="o">.</span><span class="n">track</span><span class="o">.</span><span class="n">X_to_xyz</span><span class="p">(</span><span class="mf">500.</span><span class="p">)</span>  <span class="c1"># Coordinates of shower maximum</span>
<span class="n">distance</span><span class="p">,</span> <span class="n">alt</span><span class="p">,</span> <span class="n">az</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">telescope</span><span class="o">.</span><span class="n">spherical</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="n">telescope</span> <span class="o">=</span> <span class="n">telescope</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">alt</span><span class="o">=</span><span class="n">alt</span><span class="p">,</span> <span class="n">az</span><span class="o">=</span><span class="n">az</span><span class="p">)</span>  <span class="c1"># Telescope pointing at shower maximum</span>
<span class="n">signal</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Signal</span><span class="p">(</span><span class="n">shower</span><span class="p">,</span> <span class="n">telescope</span><span class="p">)</span>

<span class="n">signal</span><span class="o">.</span><span class="n">show_projection</span><span class="p">(</span><span class="n">max_theta</span><span class="o">=</span><span class="mf">30.</span><span class="p">);</span>
<span class="n">signal</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_UC3_Signal_production_and_ground_distribution_44_0.png" src="../_images/tutorials_UC3_Signal_production_and_ground_distribution_44_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_UC3_Signal_production_and_ground_distribution_44_1.png" src="../_images/tutorials_UC3_Signal_production_and_ground_distribution_44_1.png" />
</div>
</div>
</div>
<div class="section" id="Photon-distribution-at-observation-level">
<h2>Photon distribution at observation level<a class="headerlink" href="#Photon-distribution-at-observation-level" title="Permalink to this headline">¶</a></h2>
<p>The method <code class="docutils literal notranslate"><span class="pre">show_distribution</span></code> of <code class="docutils literal notranslate"><span class="pre">Shower</span></code> calculates the photon distribution at observation level and plot it. By default, the photon distribution is calculated on a square grid of 2x2 km<span class="math notranslate nohighlight">\(^2\)</span> on ground with discretization size of 0.2 km around the origin of the coordinate system, the wavelenght range is 290-430 nm and the atmospheric transmission is included. But the grid position, height, dimensions and discretization size can be modified by the user.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">shower</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Shower</span><span class="p">(</span><span class="n">theta</span><span class="o">=</span><span class="mf">20.</span><span class="p">,</span> <span class="n">az</span><span class="o">=</span><span class="mf">30.</span><span class="p">)</span>

<span class="c1"># Default photon distribution</span>
<span class="c1"># shower.show_distribution();</span>

<span class="c1"># Setting grid position, height, dimensions and discretization size</span>
<span class="n">x_c</span><span class="p">,</span> <span class="n">y_c</span><span class="p">,</span> <span class="n">z_c</span> <span class="o">=</span> <span class="n">shower</span><span class="o">.</span><span class="n">track</span><span class="o">.</span><span class="n">h_to_xyz</span><span class="p">(</span><span class="mf">20.</span><span class="p">)</span>  <span class="c1"># Coordinates of shower point at 20 km a.s.l.</span>
<span class="n">shower</span><span class="o">.</span><span class="n">show_distribution</span><span class="p">(</span><span class="n">x_c</span><span class="o">=</span><span class="n">x_c</span><span class="p">,</span> <span class="n">y_c</span><span class="o">=</span><span class="n">y_c</span><span class="p">,</span> <span class="n">z_c</span><span class="o">=</span><span class="n">z_c</span><span class="p">,</span> <span class="n">size_x</span><span class="o">=</span><span class="mf">4.</span><span class="p">,</span> <span class="n">size_y</span><span class="o">=</span><span class="mf">4.</span><span class="p">,</span> <span class="n">N_x</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">N_y</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span>  <span class="c1"># Distribution at 20km a.s.l.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_UC3_Signal_production_and_ground_distribution_47_0.png" src="../_images/tutorials_UC3_Signal_production_and_ground_distribution_47_0.png" />
</div>
</div>
<p>In case of a linear grid (i.e., <code class="docutils literal notranslate"><span class="pre">N_x=1</span></code> or <code class="docutils literal notranslate"><span class="pre">N_x=1</span></code>), a 1D plot is generated instead.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">shower</span><span class="o">.</span><span class="n">show_distribution</span><span class="p">(</span><span class="n">size_x</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">N_x</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">N_y</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_UC3_Signal_production_and_ground_distribution_49_0.png" src="../_images/tutorials_UC3_Signal_production_and_ground_distribution_49_0.png" />
</div>
</div>
<p>The wavelength range can be modified and the atmospheric transmission can be turned off.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># shower.show_distribution(wvl_ini=350., wvl_fin=500., atm_trans=False);</span>
</pre></div>
</div>
</div>
<p>This method also allows for the calculation of density of photons in a given wavelengh range that would be collected by a grid of identical telescopes with a certain mirror area and field of view around a common pointing direction.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">shower</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">Shower</span><span class="p">(</span><span class="n">theta</span><span class="o">=</span><span class="mf">20.</span><span class="p">,</span> <span class="n">az</span><span class="o">=</span><span class="mf">30.</span><span class="p">)</span>
<span class="n">shower</span><span class="o">.</span><span class="n">show_distribution</span><span class="p">(</span><span class="n">telescope</span><span class="o">=</span><span class="n">telescope3</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mf">22.</span><span class="p">,</span> <span class="n">az</span><span class="o">=</span><span class="mf">30.</span><span class="p">,</span> <span class="n">wvl_ini</span><span class="o">=</span><span class="mf">300.</span><span class="p">,</span> <span class="n">wvl_fin</span><span class="o">=</span><span class="mf">450.</span><span class="p">);</span>

<span class="c1"># Equivalent to</span>
<span class="c1"># telescope5 = telescope3.copy(theta=22., az=30.)</span>
<span class="c1"># shower.show_distribution(telescope=telescope5, wvl_ini=300., wvl_fin=450.);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_UC3_Signal_production_and_ground_distribution_53_0.png" src="../_images/tutorials_UC3_Signal_production_and_ground_distribution_53_0.png" />
</div>
</div>
<p>Note: If <code class="docutils literal notranslate"><span class="pre">wvl_ini</span></code>, <code class="docutils literal notranslate"><span class="pre">wvl_fin</span></code> and <code class="docutils literal notranslate"><span class="pre">wvl_step</span></code> are not given, those of the input telescope will be used (but not the detection efficiency).</p>
<p>In this case, the telescope efficiency can be turn on to obtain the photoelectron distribution instead of the photon distribution.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">shower</span><span class="o">.</span><span class="n">show_distribution</span><span class="p">(</span><span class="n">telescope</span><span class="o">=</span><span class="n">telescope3</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mf">22.</span><span class="p">,</span> <span class="n">az</span><span class="o">=</span><span class="mf">30.</span><span class="p">,</span> <span class="n">tel_eff</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_UC3_Signal_production_and_ground_distribution_56_0.png" src="../_images/tutorials_UC3_Signal_production_and_ground_distribution_56_0.png" />
</div>
</div>
<p>Note: If <code class="docutils literal notranslate"><span class="pre">tel_eff=True</span></code>, the parameters <code class="docutils literal notranslate"><span class="pre">wvl_ini</span></code>, <code class="docutils literal notranslate"><span class="pre">wvl_fin</span></code> and <code class="docutils literal notranslate"><span class="pre">wvl_step</span></code> are unused, because the wavelenght range defined in the input <code class="docutils literal notranslate"><span class="pre">Telescope</span></code> object is always used.</p>
<p>Help on <code class="docutils literal notranslate"><span class="pre">show_distribution</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># shower.show_distribution?</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="UC4_Observatory_events.html" class="btn btn-neutral float-right" title="Use case 4: Observatory events" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="UC2_Shower_profile.html" class="btn btn-neutral float-left" title="Use case 2: Shower profiles" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Jaime Rosado and Daniel Morcuende

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>